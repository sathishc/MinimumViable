!function(e){var t=function(n,r,i){i&&(i.stopPropagation(),i.preventDefault()),this.$element=e(n),this.$newElement=null,this.button=null,this.options=e.extend({},e.fn.selectpicker.defaults,this.$element.data(),typeof r=="object"&&r),this.options.title==null&&(this.options.title=this.$element.attr("title")),this.val=t.prototype.val,this.render=t.prototype.render,this.refresh=t.prototype.refresh,this.setStyle=t.prototype.setStyle,this.selectAll=t.prototype.selectAll,this.deselectAll=t.prototype.deselectAll,this.init()};t.prototype={constructor:t,init:function(t){this.options.container?this.$element.css("visibility","hidden"):this.$element.hide(),this.multiple=this.$element.prop("multiple");var n=this.$element.attr("id");this.$newElement=this.createView(),this.$element.after(this.$newElement),this.options.container&&this.selectPosition(),this.button=this.$newElement.find("> button");if(n!==undefined){var r=this;this.button.attr("data-id",n),e('label[for="'+n+'"]').click(function(){r.button.focus()})}this.multiple&&this.$newElement.addClass("show-tick"),this.checkDisabled(),this.checkTabIndex(),this.clickListener(),this.render(),this.liHeight(),this.setStyle()},createDropdown:function(){var t="<div class='btn-group bootstrap-select'><button type='button' class='btn dropdown-toggle' data-toggle='dropdown'><div class='filter-option pull-left'></div>&nbsp;<div class='caret'></div></button><div class='dropdown-menu open'><ul class='dropdown-menu inner' role='menu'></ul></div></div>";return e(t)},createView:function(){var e=this.createDropdown(),t=this.createLi();return e.find("ul").append(t),e},reloadLi:function(){this.destroyLi();var e=this.createLi();this.$newElement.find("ul").append(e)},destroyLi:function(){this.$newElement.find("li").remove()},createLi:function(){var t=this,n=[],r="";return this.$element.find("option").each(function(r){var i=e(this),s=i.attr("class")||"",o=i.html(),u=i.data("subtext")!==undefined?'<small class="muted">'+i.data("subtext")+"</small>":"",a=i.data("icon")!==undefined?'<i class="'+i.data("icon")+'"></i> ':"";a!==""&&(i.is(":disabled")||i.parent().is(":disabled"))&&(a="<span>"+a+"</span>"),o=a+'<span class="text">'+o+u+"</span>";if(t.options.hideDisabled&&(i.is(":disabled")||i.parent().is(":disabled")))n.push('<a style="min-height: 0; padding: 0"></a>');else if(i.parent().is("optgroup")&&i.data("divider")!=1)if(i.index()==0){var f=i.parent().attr("label"),l=i.parent().data("subtext")!==undefined?'<small class="muted">'+i.parent().data("subtext")+"</small>":"",c=i.parent().data("icon")?'<i class="'+i.parent().data("icon")+'"></i> ':"";f=c+'<span class="text">'+f+l+"</span>",i[0].index!=0?n.push('<div class="div-contain"><div class="divider"></div></div><dt>'+f+"</dt>"+t.createA(o,"opt "+s)):n.push("<dt>"+f+"</dt>"+t.createA(o,"opt "+s))}else n.push(t.createA(o,"opt "+s));else i.data("divider")==1?n.push('<div class="div-contain"><div class="divider"></div></div>'):e(this).data("hidden")==1?n.push(""):n.push(t.createA(o,s))}),e.each(n,function(e,t){r+="<li rel="+e+">"+t+"</li>"}),!this.multiple&&this.$element.find("option:selected").length==0&&!t.options.title&&this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),e(r)},createA:function(e,t){return'<a tabindex="0" class="'+t+'">'+e+'<i class="icon-ok check-mark"></i>'+"</a>"},render:function(){var t=this;this.$element.find("option").each(function(n){t.setDisabled(n,e(this).is(":disabled")||e(this).parent().is(":disabled")),t.setSelected(n,e(this).is(":selected"))});var n=this.$element.find("option:selected").map(function(n,r){var i=e(this),s=i.data("icon")&&t.options.showIcon?'<i class="'+i.data("icon")+'"></i> ':"",o;return t.options.showSubtext&&i.attr("data-subtext")&&!t.multiple?o=' <small class="muted">'+i.data("subtext")+"</small>":o="",i.attr("title")!=undefined?i.attr("title"):s+i.text()+o}).toArray(),r=this.multiple?n.join(", "):n[0];if(t.multiple&&t.options.selectedTextFormat.indexOf("count")>-1){var i=t.options.selectedTextFormat.split(">"),s=this.options.hideDisabled?":not([disabled])":"";if(i.length>1&&n.length>i[1]||i.length==1&&n.length>=2)r=t.options.countSelectedText.replace("{0}",n.length).replace("{1}",this.$element.find('option:not([data-divider="true"]):not([data-hidden="true"])'+s).length)}r||(r=t.options.title!=undefined?t.options.title:t.options.noneSelectedText);var o;this.options.showSubtext&&this.$element.find("option:selected").attr("data-subtext")?o=' <small class="muted">'+this.$element.find("option:selected").data("subtext")+"</small>":o="",t.$newElement.find(".filter-option").html(r+o)},setStyle:function(e,t){this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker/gi,""));var n=e?e:this.options.style;t=="add"?this.button.addClass(n):(this.button.removeClass(this.options.style),this.button.addClass(n))},liHeight:function(){var e=this.$newElement.clone();e.appendTo("body");var t=e.addClass("open").find(".dropdown-menu li > a").outerHeight();e.remove(),this.$newElement.data("liHeight",t)},setSize:function(){this.options.container&&this.$newElement.toggle(this.$element.parent().is(":visible"));var t=this,n=this.$newElement.find("> .dropdown-menu"),r=n.find(".inner"),i=r.find("li > a"),s=this.$newElement.outerHeight(),o=this.$newElement.data("liHeight"),u=n.find("li .divider").outerHeight(!0),a=parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"))+parseInt(n.css("border-top-width"))+parseInt(n.css("border-bottom-width")),f=this.options.hideDisabled?":not(.disabled)":"",l;if(this.options.size=="auto"){var c=function(){var i=t.$newElement.offset().top,u=i-e(window).scrollTop(),f=e(window).height(),c=a+parseInt(n.css("margin-top"))+parseInt(n.css("margin-bottom"))+2,h=f-u-s-c,p;l=h,t.$newElement.hasClass("dropup")&&(l=u-c),n.find("li").length+n.find("dt").length>3?p=o*3+c-2:p=0,n.css({"max-height":l+"px",overflow:"hidden","min-height":p+"px"}),r.css({"max-height":l-a+"px","overflow-y":"auto"})};c(),e(window).resize(c),e(window).scroll(c)}else if(this.options.size&&this.options.size!="auto"&&n.find("li"+f).length>this.options.size){var h=n.find("li"+f+" > *").filter(":not(.div-contain)").slice(0,this.options.size).last().parent().index(),p=n.find("li").slice(0,h+1).find(".div-contain").length;l=o*this.options.size+p*u+a,n.css({"max-height":l+"px",overflow:"hidden"}),r.css({"max-height":l-a+"px","overflow-y":"auto"})}if(this.options.width=="auto"){this.$newElement.find(".dropdown-menu").css("min-width","0");var d=this.$newElement.find(".dropdown-menu").css("width");this.$newElement.css("width",d),this.options.container&&this.$element.css("width",d)}else this.options.width?this.options.container?(this.$element.css("width",this.options.width),this.$newElement.width(this.$element.outerWidth())):this.$newElement.css("width",this.options.width):this.options.container&&this.$newElement.width(this.$element.outerWidth())},selectPosition:function(){var t=e(this.options.container).offset(),n=this.$element.offset();if(t&&n){var r=n.top-t.top,i=n.left-t.left;this.$newElement.appendTo(this.options.container),this.$newElement.css({position:"absolute",top:r+"px",left:i+"px"})}},refresh:function(){this.reloadLi(),this.render(),this.setSize(),this.setStyle(),this.checkDisabled(),this.options.container&&this.selectPosition()},setSelected:function(e,t){t?this.$newElement.find("li").eq(e).addClass("selected"):this.$newElement.find("li").eq(e).removeClass("selected")},setDisabled:function(e,t){t?this.$newElement.find("li").eq(e).addClass("disabled").find("a").attr("href","#").attr("tabindex",-1):this.$newElement.find("li").eq(e).removeClass("disabled").find("a").removeAttr("href").attr("tabindex",0)},isDisabled:function(){return this.$element.is(":disabled")||this.$element.attr("readonly")},checkDisabled:function(){this.isDisabled()?(this.button.addClass("disabled"),this.button.click(function(e){e.preventDefault()}),this.button.attr("tabindex","-1")):!this.isDisabled()&&this.button.hasClass("disabled")&&(this.button.removeClass("disabled"),this.button.click(function(){return!0}),this.button.removeAttr("tabindex"))},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var e=this.$element.attr("tabindex");this.button.attr("tabindex",e)}},clickListener:function(){var t=this;e("body").on("touchstart.dropdown",".dropdown-menu",function(e){e.stopPropagation()}),this.$newElement.on("click",function(){t.setSize()}),this.$newElement.on("click","li a",function(n){var r=e(this).parent().index(),i=e(this).parent(),s=i.parents(".bootstrap-select"),o=t.$element.val();t.multiple&&n.stopPropagation(),n.preventDefault();if(t.$element.not(":disabled")&&!e(this).parent().hasClass("disabled")){if(!t.multiple)t.$element.find("option").prop("selected",!1),t.$element.find("option").eq(r).prop("selected",!0);else{var u=t.$element.find("option").eq(r).prop("selected");u?t.$element.find("option").eq(r).prop("selected",!1):t.$element.find("option").eq(r).prop("selected",!0)}s.find("button").focus(),o!=t.$element.val()&&t.$element.trigger("change"),t.render()}}),this.$newElement.on("click","li.disabled a, li dt, li .div-contain",function(t){t.preventDefault(),t.stopPropagation();var n=e(this).parent().parents(".bootstrap-select");n.find("button").focus()}),this.$element.on("change",function(e){t.render()})},val:function(e){return e!=undefined?(this.$element.val(e),this.$element.trigger("change"),this.$element):this.$element.val()},selectAll:function(){this.$element.find("option").prop("selected",!0).attr("selected","selected"),this.render()},deselectAll:function(){this.$element.find("option").prop("selected",!1).removeAttr("selected"),this.render()},keydown:function(t){var n,r,i,s,o,u,a,f,l;n=e(this),i=n.parent(),r=e("[role=menu] li:not(.divider):visible a",i);if(!r.length)return;if(/(38|40)/.test(t.keyCode))s=r.index(r.filter(":focus")),u=r.parent(":not(.disabled)").first().index(),a=r.parent(":not(.disabled)").last().index(),o=r.eq(s).parent().nextAll(":not(.disabled)").eq(0).index(),f=r.eq(s).parent().prevAll(":not(.disabled)").eq(0).index(),l=r.eq(o).parent().prevAll(":not(.disabled)").eq(0).index(),t.keyCode==38&&(s!=l&&s>f&&(s=f),s<u&&(s=u)),t.keyCode==40&&(s!=l&&s<o&&(s=o),s>a&&(s=a)),r.eq(s).focus();else{var c={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},h=[];r.each(function(){e(this).parent().is(":not(.disabled)")&&e.trim(e(this).text().toLowerCase()).substring(0,1)==c[t.keyCode]&&h.push(e(this).parent().index())});var p=e(document).data("keycount");p++,e(document).data("keycount",p);var d=e.trim(e(":focus").text().toLowerCase()).substring(0,1);d!=c[t.keyCode]?(p=1,e(document).data("keycount",p)):p>=h.length&&e(document).data("keycount",0),r.eq(h[p-1]).focus()}/(13)/.test(t.keyCode)&&(e(":focus").click(),i.addClass("open"),e(document).data("keycount",0))},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()}},e.fn.selectpicker=function(n,r){var i=arguments,s,o=this.each(function(){if(e(this).is("select")){var o=e(this),u=o.data("selectpicker"),a=typeof n=="object"&&n;if(!u)o.data("selectpicker",u=new t(this,a,r));else if(a)for(var f in a)u.options[f]=a[f];if(typeof n=="string"){var l=n;u[l]instanceof Function?([].shift.apply(i),s=u[l].apply(u,i)):s=u.options[l]}}});return s!=undefined?s:o},e.fn.selectpicker.defaults={style:null,size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",countSelectedText:"{0} of {1} selected",width:null,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0},e(document).data("keycount",0).on("keydown","[data-toggle=dropdown], [role=menu]",t.prototype.keydown)}(window.jQuery);